from pwn import *

elf = ELF("./challenge")
# io = process("./challenge")
io = remote("svc.pwnable.xyz", 30031)

s2 = [
    0x11, 0xde, 0xcf, 0x10, 0xdf, 0x75, 0xbb, 0xa5,
    0x43, 0x1e, 0x9d, 0xc2, 0xe3, 0xbf, 0xf5, 0xd6,
    0x96, 0x7f, 0xbe, 0xb0, 0xbf, 0xb7, 0x96, 0x1d,
    0xa8, 0xbb, 0x0a, 0xd9, 0xbf, 0xc9, 0x0d, 0xff
]
main = [
    0x55, 0x48, 0x89, 0xe5, 0x48, 0x83, 0xec, 0x50,
    0x64, 0x48, 0x8b, 0x04, 0x25, 0x28, 0x00, 0x00,
    0x00, 0x48, 0x89, 0x45, 0xf8, 0x31, 0xc0, 0xe8,
    0x24, 0xfe, 0xff, 0xff, 0x48, 0x8d, 0x45, 0xc0
]

s1 = []
for i in range(32):
    for char in range(256):
        tmp = ((char >> 4) | (char << 4)) ^ main[i]
        if tmp % 256 == s2[i]:
            s1 += [char]
            break

print(bytes(s1))
io.sendafter(b"> ", b'1')
io.sendafter(b": ", bytes(s1))
io.sendlineafter(b"> ", b'4')

io.interactive()